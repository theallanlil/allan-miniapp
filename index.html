<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hello, Warpcast!</title>

  <!-- Farcaster embed card -->
  <meta name="fc:miniapp" content='{
    "version":"1",
    "imageUrl":"https://YOUR_DOMAIN/og.png",
    "button":{"title":"Open","action":{"type":"launch_miniapp","url":"https://YOUR_DOMAIN/"}}
  }' />

  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; background: #0e0f13; color: #e6e6e6; display: grid; place-items: center; min-height: 100dvh; }
    .card { width: min(560px, 92vw); border: 1px solid #2b2f3a; border-radius: 16px; padding: 24px; background: #14161c; box-shadow: 0 10px 30px rgba(0,0,0,.35); }
    h1 { margin: 0 0 12px 0; font-size: 28px; }
    p { opacity: .9; }
    .row { display: flex; gap: 16px; align-items: center; }
    .pfp { width: 72px; height: 72px; border-radius: 50%; overflow: hidden; background: #222; flex: 0 0 auto; }
    .pfp img { width: 100%; height: 100%; object-fit: cover; }
    .open { margin-top: 16px; display: inline-block; padding: 12px 16px; border-radius: 10px; border: 1px solid #2b2f3a; text-decoration: none; color: #e6e6e6; }
    .note { font-size: 13px; opacity: .8; margin-top: 8px; }
    .hide { display: none; }
  </style>
</head>
<body>
  <div class="card">
    <div class="row">
      <div class="pfp" id="pfp"></div>
      <div>
        <h1 id="hello">Loading‚Ä¶</h1>
        <p id="sub">Welcome to your first Farcaster Mini App üéâ</p>
      </div>
    </div>
    <a class="open" id="openLink" href="#">Open in Warpcast</a>
    <div class="note">Tip: if you see ‚ÄúLoading‚Ä¶‚Äù forever, ensure <code>sdk.actions.ready()</code> resolves and the app is served over HTTPS.</div>
    <div id="fallback" class="note hide">Looks like we are outside a Farcaster client. You can still deploy and test via the Mini App Debug Tool.</div>
  </div>

  <script type="module">
    import { sdk } from 'https://esm.sh/@farcaster/miniapp-sdk'

    const hello = document.getElementById('hello')
    const pfp = document.getElementById('pfp')
    const sub = document.getElementById('sub')
    const fallback = document.getElementById('fallback')
    const openLink = document.getElementById('openLink')

    const YOUR_DOMAIN = "YOUR_DOMAIN"
    openLink.href = `https://farcaster.xyz/miniapps/launch?url=${encodeURIComponent('https://' + YOUR_DOMAIN + '/')}`

    ;(async () => {
      try {
        await sdk.actions.ready()
        const user = await sdk.user.getInfo().catch(() => null)
        const name = user?.username || 'friend'
        hello.textContent = `üëã Hello, ${name}!`
        if (user?.pfpUrl) {
          const img = new Image()
          img.src = user.pfpUrl
          img.alt = 'pfp'
          img.referrerPolicy = 'no-referrer'
          pfp.appendChild(img)
        } else {
          pfp.style.background = '#222'
        }
      } catch (e) {
        fallback.classList.remove('hide')
        console.error('MiniApp init error:', e)
      }
    })()
  </script>
</body>
</html>
